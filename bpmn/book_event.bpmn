<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Definitions_1ri0jzd" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="2.0.3">
  <bpmn:collaboration id="Collaboration_0ynv6lv">
    <bpmn:participant id="Participant_12upb4w" name="Customer" />
    <bpmn:participant id="Participant_16dp37m" name="Booking Service" processRef="booking-service" />
    <bpmn:participant id="Participant_1hzv68c" name="Payment Gateway" />
    <bpmn:messageFlow id="MessageFlow_1n09m7n" sourceRef="SendTask_1plem9n" targetRef="Participant_12upb4w" />
    <bpmn:messageFlow id="MessageFlow_0hf9q5p" sourceRef="Participant_12upb4w" targetRef="StartEvent_0y8dhav" />
    <bpmn:messageFlow id="MessageFlow_0a3itjy" sourceRef="SendTask_0d6p5j0" targetRef="Participant_1hzv68c" />
    <bpmn:messageFlow id="MessageFlow_05mg77a" sourceRef="Participant_1hzv68c" targetRef="IntermediateThrowEvent_088pdnk" />
    <bpmn:messageFlow id="MessageFlow_00kafk2" sourceRef="Task_11brdu4" targetRef="Participant_12upb4w" />
  </bpmn:collaboration>
  <bpmn:process id="booking-service" name="Book Event" isExecutable="true">
    <bpmn:laneSet id="LaneSet_1alf1dg" />
    <bpmn:sequenceFlow id="SequenceFlow_0p685cx" sourceRef="Task_11brdu4" targetRef="EndEvent_00xzohf" />
    <bpmn:sequenceFlow id="SequenceFlow_1uf768t" sourceRef="ExclusiveGateway_0w8b9dg" targetRef="Task_11brdu4" />
    <bpmn:sequenceFlow id="SequenceFlow_166cx6q" sourceRef="IntermediateThrowEvent_088pdnk" targetRef="ExclusiveGateway_0w8b9dg" />
    <bpmn:sequenceFlow id="SequenceFlow_1gfi1gt" name="Invoice Failed" sourceRef="ExclusiveGateway_0w8b9dg" targetRef="SendTask_1plem9n">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${!invoiceCreated}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_0kienzw" sourceRef="SendTask_1vqo1xn" targetRef="SendTask_0d6p5j0" />
    <bpmn:sequenceFlow id="SequenceFlow_012m60o" sourceRef="Task_0ykn9lj" targetRef="Task_0be70wt" />
    <bpmn:sequenceFlow id="SequenceFlow_18cd5mi" name="Validated" sourceRef="ExclusiveGateway_13bj9wl" targetRef="Task_0x95gfq">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${validated}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_165cutf" sourceRef="SendTask_1plem9n" targetRef="EndEvent_1txqenp" />
    <bpmn:sequenceFlow id="SequenceFlow_1p3xg63" sourceRef="Task_0be70wt" targetRef="SendTask_1vqo1xn" />
    <bpmn:sequenceFlow id="SequenceFlow_0e1yo9d" sourceRef="StartEvent_0y8dhav" targetRef="Task_0znqb9y" />
    <bpmn:sequenceFlow id="SequenceFlow_1mwvls3" sourceRef="Task_0znqb9y" targetRef="ExclusiveGateway_13bj9wl" />
    <bpmn:sequenceFlow id="SequenceFlow_0yj4jts" name="Not Validated" sourceRef="ExclusiveGateway_13bj9wl" targetRef="SendTask_1plem9n">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${!validated}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_08q2hf9" sourceRef="Task_0x95gfq" targetRef="Task_0ykn9lj" />
    <bpmn:sequenceFlow id="SequenceFlow_1srjoeo" sourceRef="SendTask_0d6p5j0" targetRef="IntermediateThrowEvent_088pdnk" />
    <bpmn:endEvent id="EndEvent_00xzohf" name="Booking Success">
      <bpmn:incoming>SequenceFlow_0p685cx</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sendTask id="Task_11brdu4" name="Show Invoice Detail">
      <bpmn:incoming>SequenceFlow_1uf768t</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0p685cx</bpmn:outgoing>
    </bpmn:sendTask>
    <bpmn:serviceTask id="Task_0znqb9y" name="Validate Booking Request" camunda:type="external" camunda:topic="validate-booking-request">
      <bpmn:incoming>SequenceFlow_0e1yo9d</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1mwvls3</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:startEvent id="StartEvent_0y8dhav" name="Event Booking Request">
      <bpmn:outgoing>SequenceFlow_0e1yo9d</bpmn:outgoing>
      <bpmn:messageEventDefinition id="MessageEventDefinition_1hkvuy9" messageRef="Message_05iz3fu" />
    </bpmn:startEvent>
    <bpmn:exclusiveGateway id="ExclusiveGateway_13bj9wl" name="Validation">
      <bpmn:incoming>SequenceFlow_1mwvls3</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_18cd5mi</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_0yj4jts</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:task id="Task_0ykn9lj" name="Create Order">
      <bpmn:incoming>SequenceFlow_08q2hf9</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_012m60o</bpmn:outgoing>
      <bpmn:dataOutputAssociation id="DataOutputAssociation_02akh2o">
        <bpmn:targetRef>DataStoreReference_1so2vse</bpmn:targetRef>
      </bpmn:dataOutputAssociation>
    </bpmn:task>
    <bpmn:task id="Task_0x95gfq" name="Calculate Order">
      <bpmn:incoming>SequenceFlow_18cd5mi</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_08q2hf9</bpmn:outgoing>
    </bpmn:task>
    <bpmn:intermediateCatchEvent id="IntermediateThrowEvent_088pdnk" name="Invoice Respond">
      <bpmn:incoming>SequenceFlow_1srjoeo</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_166cx6q</bpmn:outgoing>
      <bpmn:messageEventDefinition />
    </bpmn:intermediateCatchEvent>
    <bpmn:exclusiveGateway id="ExclusiveGateway_0w8b9dg" name="Invoice Creation Validation">
      <bpmn:incoming>SequenceFlow_166cx6q</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1gfi1gt</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_1uf768t</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sendTask id="SendTask_0d6p5j0" name="Send Invoice Request" camunda:type="external" camunda:topic="send-invoice-request">
      <bpmn:incoming>SequenceFlow_0kienzw</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1srjoeo</bpmn:outgoing>
    </bpmn:sendTask>
    <bpmn:task id="SendTask_1vqo1xn" name="Create Invoice Request">
      <bpmn:incoming>SequenceFlow_1p3xg63</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0kienzw</bpmn:outgoing>
    </bpmn:task>
    <bpmn:dataStoreReference id="DataStoreReference_1so2vse" name="Order Database" />
    <bpmn:dataStoreReference id="DataStoreReference_12orvb5" name="Ticket Database" />
    <bpmn:task id="Task_0be70wt" name="Reserve Ticket">
      <bpmn:incoming>SequenceFlow_012m60o</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1p3xg63</bpmn:outgoing>
      <bpmn:dataOutputAssociation id="DataOutputAssociation_1npgnjl">
        <bpmn:targetRef>DataStoreReference_12orvb5</bpmn:targetRef>
      </bpmn:dataOutputAssociation>
    </bpmn:task>
    <bpmn:sendTask id="SendTask_1plem9n" name="Notify Unsuccessful Booking" camunda:type="external" camunda:topic="notify-unsuccessful-booking">
      <bpmn:incoming>SequenceFlow_1gfi1gt</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_0yj4jts</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_165cutf</bpmn:outgoing>
    </bpmn:sendTask>
    <bpmn:endEvent id="EndEvent_1txqenp" name="Booking Failed">
      <bpmn:incoming>SequenceFlow_165cutf</bpmn:incoming>
    </bpmn:endEvent>
  </bpmn:process>
  <bpmn:message id="Message_0vevqo5" name="receive-invoice-respond" />
  <bpmn:message id="Message_1prv7ul" name="payment-success-notification" />
  <bpmn:message id="Message_05iz3fu" name="event-booking-request" />
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Collaboration_0ynv6lv">
      <bpmndi:BPMNShape id="Participant_12upb4w_di" bpmnElement="Participant_12upb4w">
        <dc:Bounds x="147" y="1169" width="1489" height="89" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Participant_16dp37m_di" bpmnElement="Participant_16dp37m">
        <dc:Bounds x="149" y="1277" width="1487" height="442" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Participant_1hzv68c_di" bpmnElement="Participant_1hzv68c">
        <dc:Bounds x="147" y="1741" width="1486" height="101" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_1txqenp_di" bpmnElement="EndEvent_1txqenp">
        <dc:Bounds x="696" y="1367" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="678" y="1410" width="73" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SendTask_1plem9n_di" bpmnElement="SendTask_1plem9n">
        <dc:Bounds x="533" y="1345" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="StartEvent_0y8dhav_di" bpmnElement="StartEvent_0y8dhav">
        <dc:Bounds x="218" y="1439" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="201" y="1482" width="71" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_13bj9wl_di" bpmnElement="ExclusiveGateway_13bj9wl" isMarkerVisible="true">
        <dc:Bounds x="412" y="1432" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="472" y="1450" width="48" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="DataStoreReference_12orvb5_di" bpmnElement="DataStoreReference_12orvb5">
        <dc:Bounds x="776" y="1610" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="762" y="1667" width="79" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_0be70wt_di" bpmnElement="Task_0be70wt">
        <dc:Bounds x="751" y="1490" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Task_0ykn9lj_di" bpmnElement="Task_0ykn9lj">
        <dc:Bounds x="606" y="1490" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="DataStoreReference_1so2vse_di" bpmnElement="DataStoreReference_1so2vse">
        <dc:Bounds x="631" y="1610" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="618" y="1667" width="79" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_0w8b9dg_di" bpmnElement="ExclusiveGateway_0w8b9dg" isMarkerVisible="true">
        <dc:Bounds x="1247" y="1505" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1232" y="1562" width="81" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1gfi1gt_di" bpmnElement="SequenceFlow_1gfi1gt">
        <di:waypoint x="1272" y="1505" />
        <di:waypoint x="1272" y="1460" />
        <di:waypoint x="583" y="1460" />
        <di:waypoint x="583" y="1425" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="852" y="1442" width="69" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0kienzw_di" bpmnElement="SequenceFlow_0kienzw">
        <di:waypoint x="996" y="1530" />
        <di:waypoint x="1034" y="1530" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_012m60o_di" bpmnElement="SequenceFlow_012m60o">
        <di:waypoint x="706" y="1530" />
        <di:waypoint x="751" y="1530" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_18cd5mi_di" bpmnElement="SequenceFlow_18cd5mi">
        <di:waypoint x="437" y="1482" />
        <di:waypoint x="437" y="1530" />
        <di:waypoint x="469" y="1530" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="398" y="1542" width="45" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_165cutf_di" bpmnElement="SequenceFlow_165cutf">
        <di:waypoint x="633" y="1385" />
        <di:waypoint x="696" y="1385" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1p3xg63_di" bpmnElement="SequenceFlow_1p3xg63">
        <di:waypoint x="851" y="1530" />
        <di:waypoint x="896" y="1530" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0e1yo9d_di" bpmnElement="SequenceFlow_0e1yo9d">
        <di:waypoint x="254" y="1457" />
        <di:waypoint x="283" y="1457" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1mwvls3_di" bpmnElement="SequenceFlow_1mwvls3">
        <di:waypoint x="383" y="1457" />
        <di:waypoint x="412" y="1457" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0yj4jts_di" bpmnElement="SequenceFlow_0yj4jts">
        <di:waypoint x="437" y="1457" />
        <di:waypoint x="437" y="1385" />
        <di:waypoint x="533" y="1385" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="446" y="1362" width="66" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="MessageFlow_1n09m7n_di" bpmnElement="MessageFlow_1n09m7n">
        <di:waypoint x="583" y="1345" />
        <di:waypoint x="583" y="1258" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="MessageFlow_0hf9q5p_di" bpmnElement="MessageFlow_0hf9q5p">
        <di:waypoint x="236" y="1258" />
        <di:waypoint x="236" y="1439" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DataOutputAssociation_1npgnjl_di" bpmnElement="DataOutputAssociation_1npgnjl">
        <di:waypoint x="801" y="1570" />
        <di:waypoint x="801" y="1610" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="DataOutputAssociation_02akh2o_di" bpmnElement="DataOutputAssociation_02akh2o">
        <di:waypoint x="656" y="1570" />
        <di:waypoint x="656" y="1610" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ServiceTask_0f7msl5_di" bpmnElement="Task_0znqb9y">
        <dc:Bounds x="283" y="1417" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_08q2hf9_di" bpmnElement="SequenceFlow_08q2hf9">
        <di:waypoint x="569" y="1530" />
        <di:waypoint x="606" y="1530" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Task_0x95gfq_di" bpmnElement="Task_0x95gfq">
        <dc:Bounds x="469" y="1490" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1srjoeo_di" bpmnElement="SequenceFlow_1srjoeo">
        <di:waypoint x="1134" y="1530" />
        <di:waypoint x="1173" y="1530" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="Task_0kplq9h_di" bpmnElement="SendTask_1vqo1xn">
        <dc:Bounds x="896" y="1490" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="SendTask_1cma0d7_di" bpmnElement="SendTask_0d6p5j0">
        <dc:Bounds x="1034" y="1490" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="MessageFlow_0a3itjy_di" bpmnElement="MessageFlow_0a3itjy">
        <di:waypoint x="1087" y="1570" />
        <di:waypoint x="1087" y="1739" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="IntermediateCatchEvent_1jz5u9s_di" bpmnElement="IntermediateThrowEvent_088pdnk">
        <dc:Bounds x="1173" y="1512" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1150" y="1482" width="83" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_166cx6q_di" bpmnElement="SequenceFlow_166cx6q">
        <di:waypoint x="1209" y="1530" />
        <di:waypoint x="1247" y="1530" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="MessageFlow_05mg77a_di" bpmnElement="MessageFlow_05mg77a">
        <di:waypoint x="1191" y="1735" />
        <di:waypoint x="1191" y="1548" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1uf768t_di" bpmnElement="SequenceFlow_1uf768t">
        <di:waypoint x="1297" y="1530" />
        <di:waypoint x="1333" y="1530" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="SendTask_0vr960t_di" bpmnElement="Task_11brdu4">
        <dc:Bounds x="1333" y="1490" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="MessageFlow_00kafk2_di" bpmnElement="MessageFlow_00kafk2">
        <di:waypoint x="1388" y="1490" />
        <di:waypoint x="1388" y="1258" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="EndEvent_00xzohf_di" bpmnElement="EndEvent_00xzohf">
        <dc:Bounds x="1469" y="1512" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1445" y="1555" width="85" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0p685cx_di" bpmnElement="SequenceFlow_0p685cx">
        <di:waypoint x="1433" y="1530" />
        <di:waypoint x="1469" y="1530" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
